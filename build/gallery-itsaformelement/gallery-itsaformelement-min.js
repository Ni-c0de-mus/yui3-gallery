YUI.add("gallery-itsaformelement",function(e,t){"use strict";var n,r=e.Array,i=e.Object,s=e.Lang,o=e.Intl,u=5,a=e.one("body"),f=f,l="data",c="hotkey",h=l+"-for",p=h+c,d="disabled",v="widget",m="string",g="itsa-"+v+"-parent",y="pure",b="button",w=y+"-"+b,E=w+"-active",S=" itsa"+b+"-bordered",x="date",T="time",N=x+T,C=" "+w+"-"+N+" itsa"+b+"-onlyicon",k=w+"-"+d,L=w+"-primary",A="modelattribute",O="hideatstartup",M="itsa-invisible",_="renderpromise",D="gallery",P="-itsa",H="editor",B="error",j="boolean",F="[data-formelement][data-content]",I='[data-valid="false"]',q="tipsy-formelement",R="boundingBox",U="touchstart",z="touchend",W="focus",X="blur",V="keypress",$="right",J="picker",K="click",Q="itsaicon-datetime-",G=Q+x,Y=Q+T,Z=Q+N,et=' data-formelement="true"',tt='<span class="format',nt="</span>",rt="itsa-"+c,it='<span class="'+rt+'" data-'+c+'="{'+c+'}" '+p+'="{nodeid}">$1'+nt,st="itsabutton-asktoclick",ot="^[\\w!#$%&'*+/=?`{|}~^-]+(?:\\.[\\w!#$%&'*+/=?`{|}~^-]+)*@(?:[a-zA-Z0-9-]+\\.)+[a-zA-Z]{2,}$",ut="[a-zA-Z0-9-]+(\\.[a-zA-Z0-9-]+)+(/[\\w-]+)*",at="^(http://)?"+ut,ft="^(https://)?"+ut,lt="^(https?://)?"+ut,ct="^(([-]?[1-9][0-9]*)|0)$",ht="^[-]?(([1-9][0-9]*)|0)(\\.[0-9]+)?$",pt='<label for="',dt="</label>",vt="text",mt="password",gt="email",yt="url",bt="radio",wt="checkbox",Et="hidden",St="textarea",xt="div",Tt="label",Nt="span",Ct="plain",kt="initialfocus",Lt="fullselect",At="submitonenter",Ot="number",Mt=y+"-"+bt,_t=y+"-"+wt,Dt="readonly",Pt="checked",Ht="required",Bt="name",jt="value",Ft="placeholder",It="pattern",qt="class",Rt="labelHTML",Ut="switch",zt=Ut+"ed",Wt=Ut+Tt,Xt=Ut+jt,Vt=Tt+l,$t=jt+zt,Jt=jt+"non"+zt,Kt="focusable",Qt="spinbusy",Gt="{"+d+"}",Yt="{"+Dt+"}",Zt="{"+Pt+"}",en="{"+Ht+"}",tn="{"+Bt+"}",nn="{"+jt+"}",rn="{"+Ft+"}",sn="{"+It+"}",on="{"+l+"}",un="{"+qt+"}",an="{"+Et+"}",fn='id="{id}"',ln="{"+$t+"}",cn="{"+Jt+"}",hn="{"+Vt+"}",pn="{"+Rt+"}",dn="{"+Kt+"}",vn="type",mn="submit",gn="reset",yn="<input "+vn+'="',bn="<"+b+" "+vn+'="',wn=qt+Bt,En=Tt+"Class"+Bt,Sn="{"+vn+"}",xn=' data-labeldatetime="true"',Tn=l+"-"+N+"=",Nn=l+"-"+b+vn,Cn=l+"-"+b+"sub"+vn,kn="<"+Nt+" "+fn+">UNDEFINED ELEMENTTYPE</"+Nt+">",Ln="<"+Nt+" "+fn+tn+on+an+un+">"+nn+"</"+Nt+">",An=yn+vt+'" '+fn+tn+nn+rn+Gt+en+Yt+sn+on+dn+an+un+" />",On=yn+mt+'" '+fn+tn+nn+rn+Gt+en+Yt+sn+on+dn+an+un+" />",Mn=yn+gt+'" '+fn+tn+nn+rn+Gt+en+Yt+on+dn+an+un+sn+" />",_n=yn+yt+'" '+fn+tn+nn+rn+Gt+en+Yt+on+dn+an+un+sn+" />",Dn=yn+vt+'" '+fn+tn+nn+rn+Gt+en+Yt+on+dn+an+un+sn+" />",Pn=yn+bt+'" '+fn+tn+nn+Gt+Zt+on+dn+an+un+" />",Hn=yn+wt+'" '+fn+tn+nn+Gt+Yt+Zt+on+dn+an+un+" />",Bn=yn+Et+'" '+fn+tn+nn+" />",jn="<"+St+" "+fn+tn+rn+Gt+en+Yt+on+dn+an+un+">"+nn+"</"+St+">",Fn=cn+"<"+xt+" "+fn+tn+an+on+dn+un+"></"+xt+">"+ln,In=bn+Sn+'" '+fn+tn+nn+on+dn+an+un+">"+pn+"</"+b+">",qn=cn+bn+b+'" '+fn+tn+nn+an+en+xn+Yt+" "+Tn+'"'+x+'"'+on+dn+un+"><i "+qt+'="'+G+'"></i></'+b+">"+ln,Rn=cn+bn+b+'" '+fn+tn+nn+an+en+xn+Yt+" "+Tn+'"'+T+'"'+on+dn+un+"><i "+qt+'="'+Y+'"></i></'+b+">"+ln,Un=cn+bn+b+'" '+fn+tn+nn+an+en+xn+Yt+" "+Tn+'"'+N+'"'+on+dn+un+"><i "+qt+'="'+Z+'"></i></'+b+">"+ln,zn={widget:Fn,plain:Ln,text:An,password:On,email:Mn,url:_n,number:Dn,radio:Pn,checkbox:Hn,hidden:Bn,textarea:jn,button:In,reset:In,submit:In,date:qn,time:Rn,datetime:Un},Wn=function(t,n,r,i,s,o,u,a,f){var l=s?" "+s:"",c=a?" "+M:"",p=typeof n===m&&n.length>0?" formattime-"+n:"";return i||(t==="date"?i="%x":t==="time"?i="%X":i="%x %X"),e.use(D+P+"datetimepicker"),tt+"value"+p+l+c+'" '+h+'="'+f+'"'+l+o+u+">"+e.Date.format(r,{format:i})+nt},Xn={date:!0,time:!0,datetime:!0},Vn={text:!0,number:!0,password:!0,textarea:!0,email:!0,url:!0},$n={button:!0,submit:!0,reset:!0},Jn={radio:!0,checkbox:!0},Kn=/\{\s*([^|}]+?)\s*(?:\|([^}]*))?\s*\}/g,Qn=function(t,n){return t.replace?t.replace(Kn,function(t,r){return e.Lang.isUndefined(n[r])?"":n[r]}):t};e.Node.prototype.displayInDoc=function(){var e=this,t=e.inDoc();while(e&&t)t=e.getStyle("display")!=="none",t&&(e=e.get("parentNode"));return t},n=e.ITSAFormElement={},n.getElement=function(t,r,i){var s,o,u,a;i=i||e.guid(),r=r||{},o=typeof t=="function"&&t.NAME,typeof t===m&&(t=t.toLowerCase()),s={type:t,nodeid:i,config:r,name:r.name,html:n._renderedElement(o?t.NAME:t,r,i,o)};if(o){u=t;try{a=s.widget=new u(r.widgetconfig),t.NAME===H+"Base"?e.use(D+P+H+_,function(){a.renderOnAvailable("#"+i)}):e.use(D+P+v+_,function(){a.renderOnAvailable("#"+i)})}catch(f){e.fire(B,f)}}return s},n._renderedElement=function(t,u,a,f){var p=e.merge(u),y=typeof p[Wt]===j?p[Wt]:!1,E=typeof p[Kt]===j?p[Kt]:!0,x=typeof p[Lt]===j?p[Lt]:!1,T=typeof p[At]===j?p[At]:!1,_=typeof p[O]===j?p[O]:!1,H=u.tooltip,B=u.tooltipinvalid,F=u.nossl,I=u.onlyssl,q=u.digits,R=u[jt],U=u[A],z=u[Xt],W=u[l],X=et,V=Xn[t],$=u[c],J,K,Q,G,Y,Z,rt,st,ut,vt,wt,xt,Nt,Ut,zt,Gt,Yt,Zt,en;return W&&(X+=" "+W),U&&(X+=" data-"+A+'="true"'),p[l]=X,H&&(H=H.replace(/"/g,"''"),p[l]+=' data-content="'+H+'" data-contentvalid="'+H+'"'),B&&typeof B===m&&B.length>0&&(p[l]+=' data-contentinvalid="'+B.replace(/"/g,"''")+'"'),u[kt]&&(p[l]+=" data-"+kt+'="true"'),u[Bt]&&(p[Bt]=" "+Bt+'="'+p[Bt]+'"'),Z=typeof u[Et]===j?u[Et]:!1,rt=typeof p[d]===j?p[d]:!1,p[Et]=Z?" "+Et+'="'+Et+'"':"",p[d]=rt?" "+d+'="'+d+'"':"",$&&(s.isObject($)&&(zt=o.getLang(D+"-itsaformelement")||e.config.lang,Zt=[],i.each($,function(e,t){typeof t===m&&typeof e===m&&Zt.push(t)}),Yt=0,en=zt.length,r.some(Zt,function(e){var t=e.length;return(t>Yt&&(Yt===0||t<=en)||t<Yt&&Yt>en)&&zt.match(new RegExp("^"+e))&&(Gt=e,Yt=Gt.length),e===zt}),$=$[Gt]),typeof $===m&&$.length===1&&(Ut=$.toLowerCase())),f?(p[l]+=' data-type="'+t+'"',p[qt]=' class="'+(u[wn]||"")+" "+g+(_?" "+M:"")+'"',u[Tt]&&(p[Vt]=p[Vt]||"",p[Vt]+=" data-"+v+Tt+'="true"'),p[Kt]=E?" data-"+Kt+'="true"':"",t==="slider"&&(p[z?$t:Jt]=tt+"value formatslider-"+u.name+(u[wn]?" "+u[wn]:"")+'" '+h+'="'+a+'"'+p[Et]+p[d]+">"+R+nt),t=v):(st=!u["remove"+Ht]&&(typeof p[Ht]===j?p[Ht]:t===mt),wt=typeof p[Dt]===j?p[Dt]:!1,p[Kt]=E?" data-"+Kt+'="true"':"",p[Ht]=st?" "+Ht+'="'+Ht+'"':"",p[Dt]=wt?" "+Dt+'="'+Dt+'"'
:"",u[Ft]&&(p[Ft]=" "+Ft+'="'+p[Ft]+'"'),u[It]&&(p[It]=" "+It+'="'+p[It]+'"'),t!==St&&t!==Ct&&R&&(p[jt]=" "+jt+'="'+p[jt]+'"'),t===gt?p[It]=" "+It+'="'+ot+'"':t===yt?typeof F===j&&F?p[It]=" "+It+'="'+at+'"':typeof I===j&&I?p[It]=" "+It+'="'+ft+'"':p[It]=" "+It+'="'+lt+'"':t===Ot?p[It]=" "+It+'="'+(typeof q===j&&q?ht:ct)+'"':Jn[t]?(Y=t===bt?Mt:_t,ut=typeof p[Pt]===j?p[Pt]:!1,p[Pt]=ut?" "+Pt+'="'+Pt+'"':""):$n[t]?(delete p[Tt],vt=!0,p[vn]=t,p[l]+=" data-"+b+vn+'="'+(u[b+vn]||t)+'"',Q=u.primary,K=rt,u[Qt]&&(p[l]+=" data-"+Qt+'="true"',e.use(D+"css"+P+"-animatespin")),u[Rt]||(p[Rt]=R||t),p[jt]=" "+jt+'="'+(u[jt]||e.Escape.html(p[Rt]))+'"',Ut&&(Nt=new RegExp("(?![^<]*>)("+Ut+")","i"))&&Nt.test(p[Rt])&&(p[Rt]=p[Rt].replace(Nt,s.sub(it,{hotkey:Ut,nodeid:a})),n._HKList||n._actHKList())):V&&(e.use(D+"css"+P+"-"+N),s.isDate(R)||(R=new Date),vt=!0,K=rt,p[jt]=' value="'+R.getTime()+'"',p[l]+=" data-"+N+'picker="true"',p[z?$t:Jt]=Wn(t,u.name||"",R,p.format,u[wn],p[Et],p[d],_,a)),u.removepattern&&p[It]&&(p[l]+=" data-"+It+"="+p[It].substr(9),delete p[It]),Vn[t]&&(n._TXTList||n._actTXTList()),x&&Vn[t]&&(p[l]+=" data-"+Lt+'="true"'),T&&Vn[t]&&(p[l]+=" data-"+At+'="true"'),(u[wn]||vt||_||V)&&(p[qt]=' class="'+(V?"":u[wn]||"")+(vt?" "+w+S:"")+(V?C:"")+(K?" "+k:"")+(Q?" "+L:"")+(_?" "+M:"")+'"')),G=zn[t]||kn,p[Tt]&&(Ut&&(Nt=new RegExp("(?![^<]*>)("+Ut+")","i"))&&Nt.test(p[Tt])&&(p[Tt]=p[Tt].replace(Nt,s.sub(it,{hotkey:Ut,nodeid:a})),n._HKList||n._actHKList()),Y?(p[Tt]='<span class="formatlabel">'+p[Tt]+nt,J=' class="'+Y+(u[En]?" "+u[En]:"")+'"',G=pt+'{id}"'+an+hn+J+">"+(y?G+"{label}":"{label}"+G)+dt):(J=u[En]?' class="'+u[En]+'"':"",xt=(V?"<"+Tt:pt+'{id}"')+an+hn+J+">{label}"+dt,y?G+=xt:G=xt+G)),p.id=a,Qn(G,p)},n.tooltipReadyPromise=function(){return n._tooltipreadypromise||(n._tooltipreadypromise=new e.Promise(function(t,r){var i=n.tipsyOK=(new e.Tipsy({placement:$,selector:F+":not("+I+")",showOn:[U,W],hideOn:[z,X,V],zIndex:u})).render(),s=n.tipsyInvalid=(new e.Tipsy({placement:$,selector:F+I,showOn:[U,W],hideOn:[z,X,V],zIndex:u})).render();i.get(R).addClass(),s.get(R).addClass(q+"-invalid"),i._alignTooltip=function(t){var n=this;e.Tipsy.prototype._alignTooltip.apply(n,arguments),n._lastnode=t},s._alignTooltip=function(t){var n=this;e.Tipsy.prototype._alignTooltip.apply(n,arguments),n._lastnode=t},e.batch(i.renderPromise(),s.renderPromise()).then(t,r)})),n._tooltipreadypromise},n._pressedBtn=null,n._actHKList=function(){n._HKList=!0,a.on("keydown",function(t){var r=t.charCode,i,s,o,u,a;t.altKey&&(i=String.fromCharCode(r).toLowerCase(),s=e.one("."+rt+"[data-"+c+'="'+i+'"]:not(['+d+"]):not(["+Dt+"])"),s&&(o=s.getAttribute(p),u=e.one("#"+o)),u&&(u.getStyle("visibility")==="hidden"||!u.displayInDoc())?(s=e.all("."+rt+"[data-"+c+'="'+i+'"]:not(['+d+"]):not(["+Dt+"])"),s.some(function(t,n){return n>0&&(o=t.getAttribute(p),u=e.one("#"+o),a=u&&u.getStyle("visibility")!=="hidden"&&u.displayInDoc()&&u),a})):a=u,a&&(t.halt(),a.focus(),a.get("tagName")==="BUTTON"&&(a.addClass(E),e.fire(st,{buttonNode:a}),n._pressedBtn=a)))}),a.on("keyup",function(){var e=n._pressedBtn;e&&(e.removeClass(E),n._pressedBtn=null)})},n._actTXTList=function(){n._TXTList=!0,a.delegate(W,function(t){var n=t.target,r=n.getAttribute(l+"-"+Lt)==="true",i;!r&&n.test("input")&&t.preventDefault(),i=n.getData(f),e.ITSAFormElement._activeNode=n,i?n.clearData(f):r?n.select():(n.set("selectionStart",n.get("value").length),n.set("scrollTop",999999))},function(e,t){var n=t.target;return e===n&&n.test("input[type=text],input[type=password],input[type=url],input[type=email],textarea")}),a.delegate("mousedown",function(t){var n=t.target;e.ITSAFormElement._activeNode!==n&&n.setData(f,!0)},function(e,t){var n=t.target;return e===n&&n.test("input[type=text],input[type=password],input[type=url],input[type=email],textarea")})},e.later(500,null,n.tooltipReadyPromise),r.each([x,T,N],function(t){var n={on:function(e,n,r){n._handle=e.on(K,function(e){var n=e.target;n&&n.get("tagName")!=="BUTTON"&&(n=n.get("parentNode"),e.target=n),n&&n.getAttribute(l+"-"+N)===t&&r.fire(e)})},detach:function(e,t){t._handle.detach()}};n.delegate=n.on,n.detachDelegate=n.detach,e.Event.define(t+J+K,n)}),r.each([mn,gn],function(t){var n={on:function(e,n,r){n._handle=e.on(K,function(e){var n=e.target;n&&n.get("tagName")!=="BUTTON"&&(n=n.get("parentNode"),e.target=n),n&&(n.getAttribute(Nn)===t||n.getAttribute(Nn)===b&&n.getAttribute(Cn)===t)&&r.fire(e)})},detach:function(e,t){t._handle.detach()}};n.delegate=n.on,n.detachDelegate=n.detach,e.Event.define(t+":"+K,n)})},"gallery-2013.09.25-18-27",{requires:["yui-base","node-core","node-event-delegate","datatype-date-format","event-base","event-synthetic","yui-later","promise","event-tap","event-custom","escape","intl","gallerycss-itsa-base","gallery-tipsy","gallery-itsawidgetrenderpromise"],skinnable:!0});
