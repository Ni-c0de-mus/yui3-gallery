YUI.add("gallery-itsapanel",function(e,t){"use strict";var n,r=e.Array,i=e.Lang,s="gallery",o="itsa-",u=s+"css-"+o,a=4e3,f="destroyed",l="string",c="boolean",h="visible",p="closeButton",d="closableByEscape",v="width",m="height",g="boundingBox",y="contentBox",b="paddingTop",w="paddingBottom",E="button",S="focused",x=o+S,T="keydown",N="hidden",C="View",k="panel",L="Change",A="floated",O="body",M="header"+C,_=O+C,D="footer",P=D+C,H="number",B="offsetHeight",j="offsetWidth",F="modal",I="px",q="title",R="Right",U=q+R,z="centered",W="drag",X=W+"able",V="resize",$="resizable",J="dd",K="-plugin",Q="styled",G="itsatabkeymanager",Y=o+k,Z=o+Q+k,et=o+N+k,tt=o+N+"section",nt=o+"inline"+k,rt="className",it=o+"panelheader",st=o+"panelbody",ot=o+"panelfooter",ut=o+"panelinnerheader",at=o+"panelinnerbody",ft=o+"panelinnerfooter",lt=o+k+"closebtn",ct='<div class="'+it+'"><div class="'+ut+'"></div></div>',ht='<div class="'+st+'"><div class="'+at+'"></div></div>',pt='<div class="'+ot+'"><div class="'+ft+'"></div></div>',dt="<"+E+' class="pure-'+E+" itsa"+E+"-onlyicon "+lt+'" data-focusable="true"><i class="itsaicon-form-abort"></i></'+E+">",vt='<div>{title}</div><div class="itsa-rightalign">{titleRight}</div>',mt="{body}",gt='<div>{footer}</div><div class="itsa-rightalign">{footerRight}</div>',yt="click",bt=yt+"outside",wt="value",Et="focusnext",St=E+yt,xt=E+":hide",Tt="escape:hide";n=e.ITSAPanel=e.Base.create("itsapanel",e.Widget,[e.WidgetPosition,e.WidgetModality,e.WidgetPositionAlign,e.WidgetPositionConstrain,e.WidgetStack],null,{ATTRS:{body:{value:null,validator:function(e){return e===null||typeof e===l}},bodyView:{value:null,validator:function(t){return t===null||typeof t===l||t instanceof e.View}},className:{value:null,validator:function(e){return e===null||typeof e===l}},closableByEscape:{value:!0,validator:function(e){return typeof e===c}},closeButton:{value:!0,validator:function(e){return typeof e===c}},dragable:{value:!1,validator:function(e){return typeof e===c}},footer:{value:null,validator:function(e){return e===null||typeof e===l}},footerRight:{value:null,validator:function(e){return e===null||typeof e===l}},footerView:{value:null,validator:function(t){return t===null||typeof t===l||t instanceof e.View}},floated:{value:!0,validator:function(e){return typeof e===c}},focusOnShow:{value:!0,validator:function(e){return typeof e===c}},headerView:{value:null,validator:function(t){return t===null||typeof t===l||t instanceof e.View}},height:{value:null,lazyAdd:!1,validator:function(e){return e===null||typeof e===H},getter:"_getHeight",setter:"_setHeight"},maxHeight:{value:null,lazyAdd:!1,validator:function(e){return e===null||typeof e===H},setter:"_setMaxHeight"},maxWidth:{value:null,lazyAdd:!1,validator:function(e){return e===null||typeof e===H},setter:"_setMaxWidth"},minHeight:{value:null,lazyAdd:!1,validator:function(e){return e===null||typeof e===H},setter:"_setMinHeight"},minWidth:{value:null,lazyAdd:!1,validator:function(e){return e===null||typeof e===H},setter:"_setMinWidth"},resizable:{value:!1,validator:function(e){return typeof e===c}},styled:{value:!0,validator:function(e){return typeof e===c}},visible:{value:!1,validator:function(e){return typeof e===c}},width:{value:null,lazyAdd:!1,validator:function(e){return e===null||typeof e===H},getter:"_getWidth",setter:"_setWidth"},title:{value:null,validator:function(e){return e===null||typeof e===l}},titleRight:{value:null,validator:function(e){return e===null||typeof e===l}}}}),n.prototype.initializer=function(){var t=this,n=t.get(g),r=t.get(rt);e.use(u+"base",u+"form"),t.publish(xt,{defaultFn:e.bind(t.hide,t),emitFacade:!0}),t.publish(Tt,{defaultFn:e.bind(t.hide,t),emitFacade:!0}),t._eventhandlers=[],t._partOfMultiView=!1,n.addClass(Y),n.toggleClass(nt,!t.get(A)),n.toggleClass(Z,t.get(Q)),n.toggleClass(x,t.get(S)),n.addClass(et),t.publish(Et,{defaultFn:e.bind(t._defFn_focusnext,t),emitFacade:!0}),t.get(h)&&t.get(y).addClass(x),r&&n.addClass(r),t.renderPromise().then(function(){t.get(h)&&n.removeClass(et)})},n.prototype.bindUI=function(){var t=this,n=t.get(g),r=t.get(y),s=t._eventhandlers,o=t.get(M),u=t.get(_),c=t.get(P);o instanceof e.View&&!t._partOfMultiView&&o.addTarget(t),u instanceof e.View&&u.addTarget(t),c instanceof e.View&&!t._partOfMultiView&&c.addTarget(t),t.get(X)&&t.get(A)&&e.use(J+K,function(){t.get(f)||n.plug(e.Plugin.Drag).dd.addHandle("."+it)&&n.dd.addTarget(t)}),t.get($)&&e.use(V+K,function(){t.get(f)||r.plug(e.Plugin.Resize,{handles:["r","b","br"]}).resize.addTarget(t)}),t._setFocusManager(),t.get(d)&&(t._escapeHandler=e.on(T,e.rbind(t._handleEscapeKey,t))),s.push(t.after(d+L,function(n){n.newVal?t._escapeHandler=e.on(T,e.rbind(t._handleEscapeKey,t)):t._escapeHandler&&t._escapeHandler.detach()})),s.push(t.after(h+L,function(e){var i=e.newVal;n.toggleClass(et,!i),r.toggleClass(x,i),i?(t.get(F)||t.get("focusOnShow"))&&t.focus():t.blur()})),s.push(t.after(A+L,function(r){n.toggleClass(nt,!r.newVal),t.get(X)&&(r.newVal&&!n.dd&&e.use(J+K,function(){t.get(f)||n.plug(e.Plugin.Drag).dd.addHandle("."+it)&&n.dd.addTarget(t)}),!r.newVal&&n.dd&&n.dd.removeTarget(t)&&n.unplug(J))})),s.push(t.after(X+L,function(r){r.newVal&&t.get(A)&&!n.dd&&e.use(J+K,function(){t.get(f)||n.plug(e.Plugin.Drag).dd.addHandle("."+it)&&n.dd.addTarget(t)}),!r.newVal&&n.dd&&n.dd.removeTarget(t)&&n.unplug(J)})),s.push(t.after($+L,function(n){n.newVal&&!r[V]&&e.use(V+K,function(){t.get(f)||r.plug(e.Plugin.Resize,{handles:["r","b","br"]}).resize.addTarget(t)}),!n.newVal&&r[V]&&r[V].removeTarget(t)&&r[V].unplug(V)})),s.push(t.after([W+":"+W,W+":end"],function(){var t=e.ITSAFormElement,n=t&&t.tipsyOK,r=t&&t.tipsyInvalid;n&&n.get(h)&&n._lastnode&&n._alignTooltip(n._lastnode),r&&r.get(h)&&r._lastnode&&r._alignTooltip(r._lastnode)})),s.push(t.after([V+":end",m+L,v+L,"minHeight"+L,"minWidth"+L],function(){t.get(z)&&t.centered()})),s.push(t.after([M+L,_+L,P+L],function(n){n.prevVal instanceof e.View&&n.prevVal.removeTarget(t),n.newVal instanceof e.View&&(!t._partOfMultiView||
n.type===_+L)&&n.newVal.addTarget(t)})),s.push(t.after("*:viewrendered",function(){var n=t.get(P),i,s;n&&(s=t._footercont,i=n.get("container"),s.toggleClass("itsa-inlinefooter",!0),i=n.get("container"),i.setStyle("paddingLeft","1.2em"),s.setStyle("overflow","visible"),t._body.setStyle("minWidth",""),t._body.setStyle("minWidth",t._footer.get("offsetWidth")+"px"),s.toggleClass("itsa-inlinefooter",!1),s.setStyle("overflow",""),i.setStyle("paddingLeft","")),e.later(250,null,function(){r.pluginReady(G,a).then(function(e){e.refresh(r),r.hasClass(x)&&t.get(h)&&!t._locked&&e.focusInitialItem()})})})),s.push(t.after([D+L,D+R+L],e.bind(t._renderFooter,t))),s.push(t.after([q+L,D+R+L],e.bind(t._renderFooter,t))),s.push(t.after(Q+L,function(e){n.toggleClass(Z,e.newVal)})),s.push(t.after(rt+L,function(e){e.prevVal&&n.removeClass(e.prevVal),e.newVal&&n.addClass(e.newVal)})),s.push(t.on([q+L,U+L,p+L],function(e){var n=e.newVal,r=e.type.split(":"),s=r[r.length-1],o=s===q+L?n:t.get(q),u=s===U+L?n:t.get(U),a=s===p+L?n:t.get(p),f=t.get(M);(!f||typeof f===l)&&t._header.setHTML(i.sub(f||vt,{title:o||"",titleRight:u===null?a?dt:"":u}))})),s.push(t.on(F+L,function(e){!t.get(A)&&e.preventDefault()})),s.push(t.on(_+L,e.bind(t._renderBody,t))),s.push(t.on(M+L,e.bind(t._renderHeader,t))),s.push(t.on(P+L,e.bind(t._renderFooter,t))),s.push(t._header.delegate(yt,function(e){t.fire(xt,{buttonNode:e.target})},"."+lt)),s.push(n.delegate(yt,function(e){var n=e.currentTarget,r;r={type:St,target:t,value:n&&n.get(wt),buttonNode:n},t.fire(St,r)},E)),s.push(n.on(yt,function(){t.focus()})),s.push(n.on(bt,function(){t.blur()})),s.push(t.after(S+L,function(e){var n=e.newVal&&t.get(h);t.get(y).toggleClass(x,n),n&&r.pluginReady(G,a).then(function(e){e._retreiveFocus()})})),s.push(t.after("*:viewrendered",function(){t._adjustPaddingTop(),t._adjustPaddingBottom()}))},n.prototype.renderUI=function(){var e=this,t=e.get(y);t.setHTML(ct+ht+pt),e._header=t.one("."+ut),e._body=t.one("."+at),e._footer=t.one("."+ft),e._footercont=t.one("."+ot),e._renderHeader(),e._renderBody(),e._renderFooter()},n.prototype.destructor=function(){var t=this,n=t.get(g),r=t.get(y),i=t.get(M),s=t.get(_),o=t.get(P);i instanceof e.View&&i.removeTarget(t),s instanceof e.View&&s.removeTarget(t),o instanceof e.View&&o.removeTarget(t),n.hasPlugin(J)&&n.dd.removeTarget(t)&&n.unplug(J),r.hasPlugin[V]&&r[V].removeTarget(t)&&r.unplug(V),r.hasPlugin(G)&&r.unplug(G),t._escapeHandler&&t._escapeHandler.detach(),t._clearEventhandlers()},n.prototype._adjustPaddingBottom=function(){var e=this;e.get(y).setStyle(w,e._footer.get(B)+I)},n.prototype._adjustPaddingTop=function(){var e=this;e.get(y).setStyle(b,e._header.get(B)+I)},n.prototype._clearEventhandlers=function(){r.each(this._eventhandlers,function(e){e.detach()})},n.prototype._handleEscapeKey=function(e){var t=this;e.keyCode===27&&t.get(S)&&t.fire(Tt)},n.prototype._defFn_focusnext=function(){var e=this,t=e.get(y);t.hasClass(x)&&t.pluginReady(G,a).then(function(e){e.next()},function(){})},n.prototype._getHeight=function(){return Math.round(this.get(g).get(B))},n.prototype._getWidth=function(){return Math.round(this.get(g).get(j))},n.prototype._renderHeader=function(){var t=this,n=t.get(q),r=t.get(U),s=t.get(p),o=t.get(M);!o||typeof o===l?t._header.setHTML(i.sub(o||vt,{title:n||"",titleRight:r===null?s?dt:"":r})):o instanceof e.View&&(o._set("container",t._header),o.render&&o.render()),t._adjustPaddingTop()},n.prototype._renderBody=function(){var t=this,n=t.get(O),r=t.get(_);!r||typeof r===l?t._body.setHTML(i.sub(r||mt,{body:n||""})):r instanceof e.View&&(r._set("container",t._body),r.render&&r.render())},n.prototype._renderFooter=function(){var t=this,n=t.get(D),r=t.get(D+R),s=t.get(P),o=t._footer,u=!s&&!n&&!r;u||(!s||typeof s===l?o.setHTML(i.sub(s||gt,{footer:n||"",footerRight:r||""})):s instanceof e.View&&(s._set("container",t._footer),s.render&&s.render())),t._footercont.toggleClass(tt,u),t._adjustPaddingBottom()},n.prototype._setFocusManager=function(){var t=this,n=t.get(y),r=n.itsatabkeymanager;e.use(s+"-"+G,function(){t.get(f)||(r?r.refresh(n):(n.plug(e.Plugin.ITSATabKeyManager),r=n.itsatabkeymanager),n.hasClass(x)&&r.focusInitialItem())})},n.prototype._setHeight=function(e){var t=this;t.get(y).setStyle(m,e?e+I:"")},n.prototype._setMaxHeight=function(e){this.get(y).setStyle("maxHeight",e?e+I:"")},n.prototype._setMaxWidth=function(e){this.get(y).setStyle("maxWidth",e?e+I:"")},n.prototype._setMinHeight=function(e){this.get(y).setStyle("minHeight",e?e+I:"")},n.prototype._setMinWidth=function(e){this.get(y).setStyle("minWidth",e?e+I:"")},n.prototype._setWidth=function(e){var t=this;t.get(y).setStyle(v,e?e+I:"")}},"gallery-2013.10.17-22-20",{requires:["node-pluginhost","gallery-itsapluginpromise","dd-ddm","node-event-delegate","base-build","widget-modality","widget-position","widget-position-align","widget-position-constrain","widget-stack","view","widget","gallery-itsawidgetrenderpromise"],skinnable:!0});
